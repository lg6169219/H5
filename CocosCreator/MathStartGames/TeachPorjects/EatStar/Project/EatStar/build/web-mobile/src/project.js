window.__require=function t(e,i,n){function o(a,r){if(!i[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var h="function"==typeof __require&&__require;if(!r&&h)return h(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+a+"'")}}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){return o(e[a][1][t]||t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({Boom:[function(t,e,i){"use strict";cc._RF.push(e,"dd321s7jeZJXpIaKBwwZqBe","Boom"),cc.Class({extends:cc.Component,properties:{pickRadius:0},onLoad:function(){this.enabled=!1},init:function(t){this.game=t,this.enabled=!0,this.node.opacity=255},reuse:function(t){this.init(t)},getPlayerDistance:function(){var t=this.game.player.getCenterPos();return cc.v2(this.node.x,this.node.y).sub(t).mag()},onPicked:function(){if(!this.isPicked){var t=this.node.getChildByName("boompfx");if(t)this.isPicked=!0,cc.audioEngine.playEffect(this.game.boomAudio,!1),cc.audioEngine.setEffectsVolume(.4),this.node.getComponent(cc.Sprite).enabled=!1,t.active=!0,t.getComponent("frame_anima").play_once(function(){t.active=!1;var e=this.node.getPosition();this.game.gainLife(e),this.game.despawnBoom(),this.isPicked=!1}.bind(this))}},update:function(t){this.getPlayerDistance()<this.pickRadius&&this.onPicked()}}),cc._RF.pop()},{}],EndGame:[function(t,e,i){"use strict";cc._RF.push(e,"c0f2bwqJUlODYEk6tdJFU1N","EndGame"),cc.Class({extends:cc.Component,properties:{},start:function(){var e=t("GlobalVar");this.node.getChildByName("contentLabel").getComponent(cc.RichText).string="<color=#000000>\u672c\u6b21\u6e38\u620f\u83b7\u5f97<color=#892c11>"+e.finalScore+"</color>\u5206</color>";var i=this.node.getChildByName("scoreLabel");i.getComponent(cc.RichText).string="<p align = 'left'><color=#000000>\u606d\u559c\u83b7\u5f97<color=#892c11>"+Math.floor(e.finalScore/5)+"</color>\u4e2a</color></p>",this.node.getChildByName("damuge1").x=i.x+i.width+40}}),cc._RF.pop()},{GlobalVar:"GlobalVar"}],GameLoader:[function(t,e,i){"use strict";cc._RF.push(e,"5e8d98Sz15MnI2wBSFwtgZ9","GameLoader");var n=new Object;n.sIsLoaded=!1,n.isLoaded=function(){return this.sIsLoaded},n.load=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{success:function(){},fail:function(){},onProgress:function(t,e,i){}};(new Date).getTime();cc.loader.loadResDir("/",function(e,i,n){t.onProgress&&t.onProgress(e/i,e,i)},function(e,i,o){null==e?(n.sIsLoaded=!0,t.success()):t.fail&&t.fail()})},e.exports=n,cc._RF.pop()},{}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"0486fOqHrJN+6c5PQg5FHh9","Game");var n=t("Player");t("ScoreFX"),t("Star"),cc.Class({extends:cc.Component,properties:{starPrefab:{default:null,type:cc.Prefab},boomPrefab:{default:null,type:cc.Prefab},scoreFXPrefab:{default:null,type:cc.Prefab},maxStarDuration:0,minStarDuration:0,player:{default:null,type:n},scoreDisplay:{default:null,type:cc.Label},lifeDisplay:{default:null,type:cc.Label},scoreAudio:{default:null,type:cc.AudioClip},boomAudio:{default:null,type:cc.AudioClip},btnNode:{default:null,type:cc.Node},startBgNode:{default:null,type:cc.Node},controlHintLabel:{default:null,type:cc.Label},keyboardHint:{default:"",multiline:!0},touchHint:{default:"",multiline:!0}},onLoad:function(){this.groundY=-350,this.currentStar=null,this.currentStarX=0,this.currentBoom=null,this.currentBoomX=0,this.timer=0,this.starDuration=0,this.enabled=!1;var e=cc.sys.isMobile?this.touchHint:this.keyboardHint;this.controlHintLabel.string=e,this.starPool=new cc.NodePool("Star"),this.boomPool=new cc.NodePool("Boom"),this.scorePool=new cc.NodePool("ScoreFX");var i=t("GlobalVar");this.life_count=i.lifeCount},sendRequest:function(){console.log("==========\u5185\u90e8request");this.sendMessage({status:0,type:"call"})},sendMessage:function(t){parent.iframeEvent(t)},start:function(){var e=this;window.iframeEvent=function(i){if(console.log("\u5185\u90e8\u754c\u9762\u63a5\u6536\u7684\u6d88\u606fBB"),console.log(i),i.goodsSum){var n=t("GlobalVar");n.lifeCount=i.goodsSum,e.life_count=n.lifeCount}},this.sendRequest()},onStartGame:function(){this.resetScore(),this.showLife(),this.enabled=!0,this.btnNode.active=!1,this.startBgNode.active=!1,this.player.startMoveAt(cc.v2(0,this.groundY)),this.player.changePlayerSize(this.score),this.player.getComponent(cc.Sprite).enabled=!1,this.spawnNewStar(),this.randomwCreateBoom()},spawnNewStar:function(){var t=null;t=this.starPool.size()>0?this.starPool.get(this):cc.instantiate(this.starPrefab),this.node.addChild(t),t.setPosition(this.getNewStarPosition()),t.getComponent("Star").init(this),this.startTimer(),this.currentStar=t},despawnStar:function(t){this.starPool.put(t),this.spawnNewStar(),this.despawnBoom()},getNewBoomPosition:function(){this.currentBoom||(this.currentBoomX=2*(Math.random()-.5)*this.node.width/2);var t=0,e=this.groundY+Math.random()*this.player.jumpHeight/2;e=Math.max(e,-300);var i=this.node.width/2-50;return t=this.player.node&&this.player.node.x>0?-Math.random()*i:Math.random()*i,this.currentStarX&&Math.abs(this.currentStarX-t)<100&&(this.currentStarX>t?t-=100:t+=100,t=Math.max(t,-i),t=Math.min(t,i)),cc.v2(t,e)},randomwCreateBoom:function(){Math.random()>=.5&&this.spawnNewBoom()},spawnNewBoom:function(){var t=null;(t=this.boomPool.size()>0?this.boomPool.get(this):cc.instantiate(this.boomPrefab)).getComponent(cc.Sprite).enabled=!0,this.node.addChild(t),t.setPosition(this.getNewBoomPosition()),t.getComponent("Boom").init(this),this.currentBoom=t},despawnBoom:function(){this.currentBoom&&(this.boomPool.put(this.currentBoom),this.currentBoom=null),this.randomwCreateBoom()},startTimer:function(){this.starDuration=this.minStarDuration+Math.random()*(this.maxStarDuration-this.minStarDuration),this.timer=0},getNewStarPosition:function(){this.currentStar||(this.currentStarX=2*(Math.random()-.5)*this.node.width/2);var t=0,e=this.groundY+Math.random()*this.player.jumpHeight+50;e=Math.max(e,-300);var i=this.node.width/2-50;return t=this.currentStarX>=0?-Math.random()*i:Math.random()*i,this.currentStarX=t,cc.v2(t,e)},gainLife:function(t){this.life_count-=1,this.life_count=Math.max(0,this.life_count),this.showLife(),this.life_count<=0&&this.gameOver()},showLife:function(){this.lifeDisplay.string=this.life_count.toString()},gainScore:function(t){this.score+=1,this.player.changePlayerSize(this.score),this.scoreDisplay.string="Score: "+this.score.toString();var e=this.spawnScoreFX();this.node.addChild(e.node),e.node.setPosition(t),e.play(),cc.audioEngine.playEffect(this.scoreAudio,!1)},resetScore:function(){this.score=0,this.scoreDisplay.string="Score: "+this.score.toString()},spawnScoreFX:function(){var t;return this.scorePool.size()>0?(t=this.scorePool.get()).getComponent("ScoreFX"):((t=cc.instantiate(this.scoreFXPrefab).getComponent("ScoreFX")).init(this),t)},despawnScoreFX:function(t){this.scorePool.put(t)},update:function(t){if(this.timer>this.starDuration)return this.gameOver(),void(this.enabled=!1);this.timer+=t},sendEndRequest:function(){this.sendMessage({status:2})},gameOver:function(){t("GlobalVar").finalScore=this.score,this.player.enabled=!1,this.player.stopMove(),this.currentStar.destroy(),this.currentBoom&&(this.currentBoom.destroy(),this.currentBoom=null),cc.director.loadScene("OverScene"),this.scheduleOnce(this.sendEndRequest,3)}});cc._RF.pop()},{GlobalVar:"GlobalVar",Player:"Player",ScoreFX:"ScoreFX",Star:"Star"}],GlobalVar:[function(t,e,i){"use strict";cc._RF.push(e,"47100PaXvhDD4L9UYHdhKrp","GlobalVar");e.exports={lifeCount:5,playerSizeList:{0:{scale:.6,jumpHeight:180,xSpeed:180},5:{scale:.8,jumpHeight:250,xSpeed:230},10:{scale:1,jumpHeight:300,xSpeed:280}},finalScore:0},cc._RF.pop()},{}],LoadingPageControl:[function(t,e,i){"use strict";cc._RF.push(e,"87592P6EbNCFr1z1nIuAFme","LoadingPageControl"),cc.Class({extends:cc.Component,properties:{progressBar:{default:null,type:cc.ProgressBar},loadingTipsLabel:{default:null,type:cc.Label}},onLoad:function(){var e=this;console.log("=========AAAA"),window.iframeEvent=function(i){console.log("\u5185\u90e8\u754c\u9762\u63a5\u6536\u7684\u6d88\u606fAA"),console.log(i),i.goodsSum&&(console.log(e.globalVar),e.globalVar=e.globalVar||t("GlobalVar"),e.globalVar.hammerNum=i.goodsSum)}},start:function(){var e=this,i=t("GameLoader");this.progressBar.totalLength=this.progressBar.node.width,this.progressBar.progress=0,i.isLoaded()||i.load({success:function(){e.initGameConfig()},fail:function(){e.loadingTipsLabel.string="\u5594\u5662\uff0c\u6e38\u620f\u52a0\u8f7d\u5931\u8d25\u4e86"},onProgress:function(t){e.progressBar.progress=t,e.loadingTipsLabel.string="\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d "+Math.floor(100*t)+"%"}})},initGameConfig:function(){cc.director.loadScene("game")}}),cc._RF.pop()},{GameLoader:"GameLoader",GlobalVar:"GlobalVar"}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"c10bbPdGYhDWaLoKLV38bHf","Player"),cc.Class({extends:cc.Component,properties:{jumpHeight:0,jumpDuration:0,squashDuration:0,maxMoveSpeed:0,accel:0,jumpAudio:{default:null,type:cc.AudioClip}},onLoad:function(){this.enabled=!1,this.currTarget="left",this.accRight=!1,this.xSpeed=0,this.isJumping=!1,this.minPosX=-this.node.parent.width/2,this.maxPosX=this.node.parent.width/2,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.Canvas.instance.node.on("touchend",this.onTouchEnd,this)},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.Canvas.instance.node.off("touchend",this.onTouchEnd,this)},changeAnimaTarget:function(t){if(!this.isJumping&&(t||this.tempTarget!=this.currTarget)){this.node.getChildByName("animaLeftJump").active=!1;var e=this.node.getChildByName("animaLeftWalk"),i=e.getComponent("frame_anima");e.active=!0,i.play_loop(),this.tempTarget=this.currTarget}},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.left:this.currTarget="left",this.node.scaleX=1*Math.abs(this.node.scaleX);break;case cc.macro.KEY.d:case cc.macro.KEY.right:this.currTarget="right",this.node.scaleX=-1*Math.abs(this.node.scaleX);break;case cc.macro.KEY.w:case cc.macro.KEY.up:this.isJumping||this.node.runAction(this.setJumpAction())}},onTouchEnd:function(t){var e=t.getLocation(),i=t.getStartLocation();e.y>i.y?this.isJumping||this.node.runAction(this.setJumpAction()):e.x>=cc.winSize.width/2?(this.currTarget="right",this.node.scaleX=-1*Math.abs(this.node.scaleX)):(this.currTarget="left",this.node.scaleX=1*Math.abs(this.node.scaleX))},setJumpAction:function(){this.isJumping=!0;var t=this.node.getChildByName("animaLeftWalk"),e=(t.getComponent("frame_anima"),this.node.getChildByName("animaLeftJump")),i=e.getComponent("frame_anima"),n=cc.callFunc(function(){t.active=!1,e.active=!0,i.play_once()}.bind(this),this),o=cc.delayTime(.1),s=cc.delayTime(.1),a=cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut()),r=cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn()),c=cc.callFunc(this.playJumpSound,this),h=cc.callFunc(function(){this.changeAnimaTarget(!0)}.bind(this),this);return cc.sequence(n,o,a,r,c,s,h)},playJumpSound:function(){this.isJumping=!1,cc.audioEngine.playEffect(this.jumpAudio,!1)},getCenterPos:function(){return cc.v2(this.node.x,this.node.y+this.node.height/2)},startMoveAt:function(t){this.changePlayerSize(0),this.enabled=!0,this.xSpeed=0,this.node.setPosition(t),this.changeSize=!1,this.changeAnimaTarget()},stopMove:function(){this.node.stopAllActions()},update:function(t){"left"===this.currTarget?this.xSpeed=-(this.jumpXSpeed||150):this.xSpeed=this.jumpXSpeed||150,Math.abs(this.xSpeed)>this.maxMoveSpeed&&(this.xSpeed=this.maxMoveSpeed*this.xSpeed/Math.abs(this.xSpeed)),this.node.x+=this.xSpeed*t,this.node.x>this.node.parent.width/2?this.node.x=-this.node.parent.width/2:this.node.x<-this.node.parent.width/2&&(this.node.x=this.node.parent.width/2)},changePlayerSize:function(e){var i=t("GlobalVar").playerSizeList[e];i&&(this.node.scale=i.scale,"left"===this.currTarget?this.node.scaleX=1*Math.abs(this.node.scaleX):this.node.scaleX=-1*Math.abs(this.node.scaleX),this.jumpHeight=i.jumpHeight,this.jumpXSpeed=i.xSpeed,e>0&&(this.changeSize=!0))}}),cc._RF.pop()},{GlobalVar:"GlobalVar"}],ScoreAnim:[function(t,e,i){"use strict";cc._RF.push(e,"b1f9e88YHdGr7qD17shtr2w","ScoreAnim"),cc.Class({extends:cc.Component,init:function(t){this.scoreFX=t},hideFX:function(){this.scoreFX.despawn()}}),cc._RF.pop()},{}],ScoreFX:[function(t,e,i){"use strict";cc._RF.push(e,"dd18c67pr9OM5wJb/yY6Onf","ScoreFX"),cc.Class({extends:cc.Component,properties:{anim:{default:null,type:cc.Animation}},init:function(t){this.game=t,this.anim.getComponent("ScoreAnim").init(this)},despawn:function(){this.game.despawnScoreFX(this.node)},play:function(){this.anim.play("score_pop")}}),cc._RF.pop()},{}],Star:[function(t,e,i){"use strict";cc._RF.push(e,"21890Xr4RBJlqTJhmXJ/f5s","Star"),cc.Class({extends:cc.Component,properties:{pickRadius:0},onLoad:function(){this.enabled=!1},init:function(t){this.game=t,this.enabled=!0,this.node.opacity=255},reuse:function(t){this.init(t)},getPlayerDistance:function(){var t=this.game.player.getCenterPos();return cc.v2(this.node.x,this.node.y).sub(t).mag()},onPicked:function(){var t=this.node.getPosition();this.game.gainScore(t),this.game.despawnStar(this.node)},update:function(t){if(this.getPlayerDistance()<this.pickRadius+this.game.player.node.getBoundingBox().height/2)this.onPicked();else{var e=1-this.game.timer/this.game.starDuration;this.node.opacity=50+Math.floor(205*e)}}}),cc._RF.pop()},{}],frame_anima_test:[function(t,e,i){"use strict";cc._RF.push(e,"e4f276JfJVLWI1SkFBE0tfF","frame_anima_test");var n=t("frame_anima");cc.Class({extends:cc.Component,properties:{animaHit:{type:n,default:null}},start:function(){this.animaHit.duration=.1,this.animaHit.play_loop()}}),cc._RF.pop()},{frame_anima:"frame_anima"}],frame_anima:[function(t,e,i){"use strict";cc._RF.push(e,"ae9ceO5+RVE54Bbf2+IuCYV","frame_anima"),cc.Class({extends:cc.Component,properties:{sprite_frames:{default:[],type:cc.SpriteFrame},duration:.1,loop:!1,play_onload:!1},onLoad:function(){this.end_func=null,this.is_playing=!1,this.play_time=0,this.sprite=this.node.getComponent(cc.Sprite),this.sprite||(this.sprite=this.node.addComponent(cc.Sprite)),this.saveX=this.node.x,this.saveY=this.node.y,this.play_onload&&(this.loop?this.play_loop():this.play_once(null))},stopAnima:function(){},play_loop:function(){this.sprite_frames.length<=0||(this.loop=!0,this.end_func=null,this.is_playing=!0)},play_once:function(t,e){this.sprite_frames.length<=0||(this.play_time=e||0,this.end_func=t,this.loop=!1,this.is_playing=!0)},reset_anima:function(){this.sprite&&(this.sprite.spriteFrame=this.sprite_frames[0])},update:function(t){if(this.is_playing){this.play_time+=t;var e=Math.floor(this.play_time/this.duration);if(this.loop){for(;e>=this.sprite_frames.length;)e-=this.sprite_frames.length,this.play_time-=this.sprite_frames.length*this.duration;this.sprite.spriteFrame=this.sprite_frames[e]}else e>=this.sprite_frames.length?(this.is_playing=!1,this.end_func&&this.end_func()):this.sprite.spriteFrame=this.sprite_frames[e]}},getCurrTime:function(){return this.play_time}}),cc._RF.pop()},{}]},{},["Boom","EndGame","Game","GlobalVar","Player","ScoreAnim","ScoreFX","Star","frame_anima","frame_anima_test","GameLoader","LoadingPageControl"]);