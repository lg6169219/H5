{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\loading_page/assets\\scripts\\loading_page\\LoadingPageControl.js"],"names":["cc","Class","extends","Component","properties","progressBar","default","type","ProgressBar","loadingTipsLabel","Label","onLoad","self","console","log","window","iframeEvent","obj","goodsSum","globalVar","require","hammerNum","start","GameResourceLoader","totalLength","node","width","progress","isLoaded","load","success","initGameConfig","fail","string","onProgress","percent","Math","floor","director","loadScene"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAc;AACVC,qBAAU,IADA;AAEVC,kBAAOP,GAAGQ;AAFA,SADN;AAKRC,0BAAmB;AACfH,qBAAU,IADK;AAEfC,kBAAOP,GAAGU;AAFK;AALX,KAHP;;AAcL;AACAC,UAfK,oBAeK;AACN,YAAIC,OAAO,IAAX;AACAC,gBAAQC,GAAR,CAAY,eAAZ;AACAC,eAAOC,WAAP,GAAqB,UAASC,GAAT,EAAa;AAC9BJ,oBAAQC,GAAR,CAAY,aAAZ;AACAD,oBAAQC,GAAR,CAAYG,GAAZ;AACA,gBAAIA,IAAIC,QAAR,EAAiB;AACbL,wBAAQC,GAAR,CAAYF,KAAKO,SAAjB;AACAP,qBAAKO,SAAL,GAAiBP,KAAKO,SAAL,IAAkBC,QAAQ,WAAR,CAAnC;AACAR,qBAAKO,SAAL,CAAeE,SAAf,GAA2BJ,IAAIC,QAA/B;AACH;AACJ,SARD;AASH,KA3BI;AA4BLI,SA5BK,mBA4BG;AAAA;;AACJ,YAAIC,qBAAqBH,QAAQ,YAAR,CAAzB;AACA,aAAKf,WAAL,CAAiBmB,WAAjB,GAA+B,KAAKnB,WAAL,CAAiBoB,IAAjB,CAAsBC,KAArD;AACA,aAAKrB,WAAL,CAAiBsB,QAAjB,GAA4B,CAA5B;;AAEA,YAAI,CAACJ,mBAAmBK,QAAnB,EAAL,EAAoC;AAChCL,+BAAmBM,IAAnB,CAAwB;AACpBC,yBAAS,mBAAM;AACX;AACA;AACA,0BAAKC,cAAL;AACH,iBALmB;AAMpBC,sBAAM,gBAAM;AACR,0BAAKvB,gBAAL,CAAsBwB,MAAtB;AACH,iBARmB;AASpBC,4BAAY;AACR;;;AAGAC,uBAJQ,EAKP;AACD,0BAAK9B,WAAL,CAAiBsB,QAAjB,GAA4BQ,OAA5B;AACA,0BAAK1B,gBAAL,CAAsBwB,MAAtB,mDAA0CG,KAAKC,KAAL,CAAWF,UAAU,GAArB,CAA1C;AACH;AAjBmB,aAAxB;AAmBH;AACJ,KAtDI;;AAuDL;;;AAGAJ,kBA1DK,4BA0DY;AACb/B,WAAGsC,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA/EK,CAAT","file":"LoadingPageControl.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\loading_page","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        progressBar : {\r\n            default : null,\r\n            type : cc.ProgressBar\r\n        },\r\n        loadingTipsLabel : {\r\n            default : null,\r\n            type : cc.Label\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {    \r\n        var self = this;\r\n        console.log(\"=========AAAA\");\r\n        window.iframeEvent = function(obj){\r\n            console.log(\"内部界面接收的消息AA\");\r\n            console.log(obj);\r\n            if (obj.goodsSum){\r\n                console.log(self.globalVar);\r\n                self.globalVar = self.globalVar || require('GlobalVar');\r\n                self.globalVar.hammerNum = obj.goodsSum;\r\n            }\r\n        }\r\n    },\r\n    start() {\r\n        var GameResourceLoader = require(\"GameLoader\")\r\n        this.progressBar.totalLength = this.progressBar.node.width;\r\n        this.progressBar.progress = 0;\r\n\r\n        if (!GameResourceLoader.isLoaded()) {\r\n            GameResourceLoader.load({\r\n                success: () => {\r\n                    // 游戏资源加载成功之后\r\n                    // 1. 读取游戏配置文件\r\n                    this.initGameConfig();\r\n                },\r\n                fail: () => {\r\n                    this.loadingTipsLabel.string = `喔噢，游戏加载失败了`;\r\n                },\r\n                onProgress: (\r\n                    /**\r\n                     * 加载进度[0,1]\r\n                     */\r\n                    percent\r\n                ) => {\r\n                    this.progressBar.progress = percent;\r\n                    this.loadingTipsLabel.string = `正在努力加载中 ${Math.floor(percent * 100)}%`;\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *  初始化游戏配置\r\n     */\r\n    initGameConfig() {\r\n        cc.director.loadScene(\"game\");\r\n    }\r\n    // update (dt) {},\r\n\r\n    // //预加载主游戏页面图片资源数组\r\n    // findRes(jsonData) {\r\n    //     for (let key in jsonData) {\r\n    //         if (typeof jsonData[key] == \"string\") {\r\n    //             if (key == \"progressdi\" || key == \"progressshang\" || key == \"loadbg\") {\r\n    //                 this.preres.push(jsonData[key]);\r\n    //             } else {\r\n    //                 var s = jsonData[key].split(\"/\");\r\n    //                 if (s.length && s.length > 1) {\r\n    //                     this.res.push(jsonData[key]);\r\n    //                 }\r\n    //             }\r\n    //         } else if (typeof jsonData[key] == \"object\") {\r\n    //             this.findRes(jsonData[key]);\r\n    //         }\r\n    //     }\r\n    // }\r\n});\r\n"]}