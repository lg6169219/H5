{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\anima/assets\\scripts\\anima\\frame_anima.js"],"names":["cc","Class","extends","Component","properties","sprite_frames","default","type","SpriteFrame","duration","loop","play_onload","onLoad","end_func","is_playing","play_time","sprite","node","getComponent","Sprite","addComponent","saveX","x","saveY","y","play_loop","play_once","stopAnima","length","currTime","reset_anima","spriteFrame","update","dt","index","Math","floor","getCurrTime"],"mappings":"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","file":"frame_anima.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\anima","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 帧动画的图片，多张图片\n        sprite_frames : {\n            default : [],\n            type : cc.SpriteFrame,\n        },\n\n        duration : 0.1, // 帧时间间隔\n        loop : false, // 是否循环播放\n        play_onload : false, // 是否在加载时候就开始播放\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.end_func = null;\n        this.is_playing = false;\n        this.play_time = 0; //播放动画的时间\n\n        this.sprite = this.node.getComponent(cc.Sprite);\n        if(!this.sprite){\n            this.sprite = this.node.addComponent(cc.Sprite);\n        }\n\n        this.saveX = this.node.x;\n        this.saveY = this.node.y;\n\n        // 加载时候开始播放\n        if(this.play_onload){\n            if(this.loop){\n                this.play_loop();\n            }else{\n                this.play_once(null);\n            }\n        }\n    },\n\n    stopAnima () {\n        // this.is_playing = false;\n    },\n    play_loop : function(){\n        if(this.sprite_frames.length <= 0){\n            return;\n        }\n\n        this.loop = true;\n        this.end_func = null;\n\n        this.is_playing = true;\n    },\n\n    // 需要播放结束回调\n    play_once : function(end_func, currTime){\n        if(this.sprite_frames.length <= 0){\n            return;\n        }\n        this.play_time = currTime || 0;\n        this.end_func = end_func;\n\n        this.loop = false;\n        this.is_playing = true;\n    },\n\n    reset_anima : function(){\n        if (this.sprite){\n            this.sprite.spriteFrame = this.sprite_frames[0];\n        }\n    },\n\n    update (dt) {\n        if(!this.is_playing){\n            return;\n        }\n\n        this.play_time += dt;\n        var index = Math.floor(this.play_time / this.duration);\n        // 非循环播放\n        if(!this.loop){\n            if(index >= this.sprite_frames.length){ // 结束了\n                this.is_playing = false;\n                if(this.end_func){\n                    this.end_func();\n                }\n            }else{\n                this.sprite.spriteFrame = this.sprite_frames[index];\n            }\n        }else{\n            while(index >= this.sprite_frames.length){\n                index -= this.sprite_frames.length;\n                this.play_time -= (this.sprite_frames.length * this.duration);\n            }\n            this.sprite.spriteFrame = this.sprite_frames[index];\n        }\n    },\n\n    getCurrTime: function(){\n        return this.play_time;\n    }\n});\n"]}